#!/bin/bash

# Usage: ./scripts/pagestop <server> <name>
# Example: ./scripts/pagestop tago tago2

set -e

SERVER=$1
NAME=$2

if [ -z "$SERVER" ] || [ -z "$NAME" ]; then
  echo "Usage: $0 <server> <name>"
  echo "Example: $0 tago tago2"
  exit 1
fi

CONTAINER="pageflow-$NAME"

echo "Stopping instance on $SERVER..."
echo "  Container: $CONTAINER"
echo ""

ssh $SERVER "docker stop $CONTAINER && docker rm $CONTAINER"

# Remove from local registry
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
"$SCRIPT_DIR/../pageflow" stop $NAME

echo ""
echo "Done. Instance $NAME stopped and unregistered."
